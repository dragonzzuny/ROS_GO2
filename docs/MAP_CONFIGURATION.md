# π—ΊοΈ λ§µ κµ¬μ„± μ„¤λ… (Map Configuration)

## π“ ν„μ¬ λ§µ κµ¬μ„±

### κΈ°λ³Έ μ„¤μ •
- **λ§µ ν¬κΈ°**: 50m Γ— 50m
- **μμ°° ν¬μΈνΈ**: 4κ° (μ •μ‚¬κ°ν• ν¨ν„΄)

```
λ§µ λ μ΄μ•„μ›ƒ:
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” 50m
β”‚                                                 β”‚
β”‚   P3 (10, 40)           42.4m        P2 (40, 40)β”‚ 40m
β”‚        β—β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β—            β”‚
β”‚        β”ƒ                            β”ƒ            β”‚
β”‚        β”ƒ                            β”ƒ            β”‚
β”‚        β”ƒ          30m               β”ƒ 30m        β”‚
β”‚        β”ƒ                            β”ƒ            β”‚
β”‚        β”ƒ                            β”ƒ            β”‚
β”‚   P0 (10, 10)           30m         P1 (40, 10) β”‚ 10m
β”‚        β—β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β”β—            β”‚
β”‚                                                 β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
0m     10m                            40m        50m
```

### μμ°° ν¬μΈνΈ μΆν‘
| ν¬μΈνΈ | μΆν‘ (x, y) | μ„¤λ… |
|--------|------------|------|
| P0 | (10.0, 10.0) | μΆν•λ‹¨ (μ™Όμ½ μ•„λ) |
| P1 | (40.0, 10.0) | μ°ν•λ‹¨ (μ¤λ¥Έμ½ μ•„λ) |
| P2 | (40.0, 40.0) | μ°μƒλ‹¨ (μ¤λ¥Έμ½ μ„) |
| P3 | (10.0, 40.0) | μΆμƒλ‹¨ (μ™Όμ½ μ„) |

### κ²½λ΅ κ±°λ¦¬
| κµ¬κ°„ | κ±°λ¦¬ | μ ν• |
|------|------|------|
| P0 β†’ P1 | 30.0m | μν‰ |
| P1 β†’ P2 | 30.0m | μμ§ |
| P2 β†’ P3 | 30.0m | μν‰ |
| P3 β†’ P0 | 30.0m | μμ§ |
| **μ „μ²΄ κ²½λ΅** | **120.0m** | 1ν μμ°° |

### λ΅λ΄‡ μ„±λ¥
- **μµλ€ μ†λ„**: 1.5 m/s
- **1ν μμ°° μ‹κ°„**: ~80μ΄ (μ•½ 1.3λ¶„)
- **10λ¶„ μ—ν”Όμ†λ“**: μ•½ 7-8ν μμ°° κ°€λ¥

---

## π’΅ μ„¤κ³„ κΈ°μ¤€ (Design Rationale)

### 1. **ν…μ¤νΈ λ° λ°λ¨ λ©μ **
ν„μ¬ λ§µμ€ λ‹¤μ λ©μ μΌλ΅ μ„¤κ³„λμ—μµλ‹λ‹¤:

β… **κ°„λ‹¨λ…λ£ν• κµ¬μ΅°**
- μ •μ‚¬κ°ν• ν¨ν„΄μΌλ΅ μ΄ν•΄ν•κΈ° μ‰¬μ›€
- λ€μΉ­μ  κµ¬μ΅°λ΅ λ¶„μ„ μ©μ΄
- λΉ λ¥Έ ν”„λ΅ν† νƒ€μ΄ν•‘ κ°€λ¥

β… **μ‹κ°ν™” μΉν™”μ **
- κ·Έλν”„λ΅ ν‘ν„ν•κΈ° μ‰¬μ›€
- λ΅λ΄‡ κ²½λ΅ μ¶”μ  λ…ν™•
- μ»¤λ²„λ¦¬μ§€ λ¶„μ„ μ§κ΄€μ 

### 2. **κ· ν•μ΅ν μ»¤λ²„λ¦¬μ§€**

β… **κ³µκ°„ λ¶„ν• **
- 4κ° μ½”λ„ ν¬μΈνΈκ°€ λ§µμ„ 4λ“±λ¶„
- κ° ν¬μΈνΈκ°€ 12.5m Γ— 12.5m μμ—­ λ‹΄λ‹Ή
- μ¤‘μ•™ μμ—­λ„ μμ°° κ²½λ΅μ— ν¬ν•¨

β… **μΌμ •ν• κ±°λ¦¬**
- λ¨λ“  μ§μ„  κµ¬κ°„μ΄ 30mλ΅ λ™μΌ
- μμΈ΅ κ°€λ¥ν• μ΄λ™ μ‹κ°„
- ν•™μµ μ•μ •μ„± ν–¥μƒ

### 3. **ν„μ‹¤μ μΈ μ¤μΌ€μΌ**

β… **μ‹¤μ  ν™κ²½ κΈ°λ°**
- **50m Γ— 50m**:
  - μ¤‘ν• κ±΄λ¬Ό 1κ° μΈµ ν¬κΈ°
  - μ•Όμ™Έ μ£Όμ°¨μ¥ κµ¬μ—­
  - μΊ νΌμ¤ κ±΄λ¬Ό 1μΈµ

β… **μ‹¤μ  λ΅λ΄‡ μ‚¬μ–‘**
- **1.5 m/s**: Unitree Go2 μ‹¤μ  μµλ€ μ†λ„
- **λ°°ν„°λ¦¬**: 100Wh (5μ‹κ°„ μ΄μ)
- **LiDAR**: 10m λ²”μ„ (μ‹¤μ  μ„Όμ„ κΈ°μ¤€)

### 4. **ν™•μ¥ κ°€λ¥μ„±**

β… **μ‰¬μ΄ μ»¤μ¤ν„°λ§μ΄μ§•**
- YAML νμΌ μμ •λ§μΌλ΅ λ³€κ²½ κ°€λ¥
- μμ°° ν¬μΈνΈ κ°μ μ ν• μ—†μ
- λ‹¤μ–‘ν• ν¨ν„΄ μ§€μ›

---

## π”§ μ»¤μ¤ν„°λ§μ΄μ§• λ°©λ²•

### λ°©λ²• 1: κΈ°λ³Έ μ„¤μ • μμ •
`configs/default.yaml` νμΌμ„ μ§μ ‘ νΈμ§‘:

```yaml
env:
  map_width: 50.0
  map_height: 50.0
  patrol_points:
    - [10.0, 10.0]  # μ—¬κΈ°λ¥Ό μμ •
    - [40.0, 10.0]
    - [40.0, 40.0]
    - [10.0, 40.0]
```

### λ°©λ²• 2: μƒλ΅μ΄ μ„¤μ • νμΌ μƒμ„±

#### μμ‹ 1: λ³µλ„ν• μμ°° (κΈ΄ μ§μ„  κ²½λ΅)
`configs/corridor.yaml`:
```yaml
env:
  map_width: 60.0
  map_height: 20.0
  patrol_points:
    - [10.0, 10.0]
    - [20.0, 10.0]
    - [30.0, 10.0]
    - [40.0, 10.0]
    - [50.0, 10.0]
  event_generation_rate: 3.0  # μΆμ€ κ³µκ°„μ΄λ―€λ΅ μ΄λ²¤νΈ μ κ²

# μ‚¬μ©:
# python scripts/train.py --config configs/corridor.yaml
```

#### μμ‹ 2: Lμν• κ±΄λ¬Ό
`configs/l_shaped.yaml`:
```yaml
env:
  map_width: 50.0
  map_height: 50.0
  patrol_points:
    - [10.0, 10.0]
    - [40.0, 10.0]
    - [40.0, 25.0]
    - [25.0, 25.0]
    - [25.0, 40.0]
    - [10.0, 40.0]
  num_candidates: 6  # ν¬μΈνΈκ°€ λ§μ•„λ„ ν›„λ³΄ μλ” μ μ§€
```

#### μμ‹ 3: κ³ λ°€λ„ μμ°° (8κ° ν¬μΈνΈ)
`configs/high_density.yaml`:
```yaml
env:
  map_width: 50.0
  map_height: 50.0
  patrol_points:
    - [10.0, 10.0]
    - [25.0, 10.0]
    - [40.0, 10.0]
    - [40.0, 25.0]
    - [40.0, 40.0]
    - [25.0, 40.0]
    - [10.0, 40.0]
    - [10.0, 25.0]
  event_generation_rate: 8.0  # ν¬μΈνΈ λ§μ•„μ„ μ΄λ²¤νΈλ„ μ¦κ°€
```

#### μμ‹ 4: μ‹¤μ  κ±΄λ¬Ό (μ„μΈλ€ 302λ™ 1μΈµ)
`configs/building_302.yaml`:
```yaml
env:
  map_width: 80.0  # μ‹¤μ  κ±΄λ¬Ό ν¬κΈ°
  map_height: 40.0
  patrol_points:
    - [10.0, 10.0]  # ν„κ΄€ μ…κµ¬
    - [30.0, 10.0]  # λ΅λΉ„
    - [50.0, 10.0]  # λ³µλ„ μ¤‘κ°„
    - [70.0, 10.0]  # λΉ„μƒκµ¬
    - [70.0, 30.0]  # κ³„λ‹¨μ‹¤
    - [50.0, 30.0]  # μ‹¤ν—μ‹¤ κµ¬μ—­
    - [30.0, 30.0]  # μ‚¬λ¬΄μ‹¤ κµ¬μ—­
    - [10.0, 30.0]  # νμμ‹¤
  patrol_point_priorities:
    - 1.5  # ν„κ΄€ (μ¤‘μ”)
    - 2.0  # λ΅λΉ„ (λ§¤μ° μ¤‘μ”)
    - 1.0  # λ³µλ„
    - 1.5  # λΉ„μƒκµ¬ (μ¤‘μ”)
    - 1.0  # κ³„λ‹¨μ‹¤
    - 1.2  # μ‹¤ν—μ‹¤
    - 1.0  # μ‚¬λ¬΄μ‹¤
    - 0.8  # νμμ‹¤ (λ μ¤‘μ”)
  robot_max_velocity: 1.0  # μ‹¤λ‚΄λΌμ„ μ†λ„ μ ν•
  event_generation_rate: 10.0  # λ„“μ€ κ³µκ°„
```

---

## π“ λ§µ μ„¤μ •μ΄ ν•™μµμ— λ―ΈμΉλ” μν–¥

### 1. **λ§µ ν¬κΈ°**
- **μ‘μ€ λ§µ** (< 30m):
  - β… λΉ λ¥Έ ν•™μµ
  - β… μ μ€ νƒμƒ‰ μ‹κ°„
  - β οΈ μ ν•λ λ³µμ΅λ„

- **ν° λ§µ** (> 100m):
  - β οΈ λλ¦° ν•™μµ
  - β… ν„μ‹¤μ μΈ μ‹λ‚λ¦¬μ¤
  - β οΈ κΈ΄ μ—ν”Όμ†λ“ μ‹κ°„

### 2. **μμ°° ν¬μΈνΈ κ°μ**
- **μ μ€ ν¬μΈνΈ** (2-4κ°):
  - β… λ‹¨μν• action space
  - β… λΉ λ¥Έ μλ ΄
  - β οΈ μ ν•λ μ „λµ

- **λ§μ€ ν¬μΈνΈ** (> 8κ°):
  - β οΈ λ³µμ΅ν• μ΅°ν•©
  - β… λ‹¤μ–‘ν• μ „λµ ν•™μµ
  - β οΈ ν•™μµ μ‹κ°„ μ¦κ°€

### 3. **μ΄λ²¤νΈ λ°μƒλ¥ **
- **λ‚®μ€ λ°μƒλ¥ ** (< 3.0):
  - μ£Όλ΅ μμ°° μ¤‘μ‹¬
  - μ»¤λ²„λ¦¬μ§€ μµμ ν™” ν•™μµ

- **λ†’μ€ λ°μƒλ¥ ** (> 8.0):
  - μ£Όλ΅ μ΄λ²¤νΈ λ€μ‘ μ¤‘μ‹¬
  - κΈ΄κΈ‰ μƒν™© μ²λ¦¬ ν•™μµ

---

## π― κ¶μ¥ μ„¤μ •

### μ΄κΈ° ν•™μµ / ν…μ¤νΈ
```yaml
# configs/quick_test.yaml
env:
  map_width: 30.0
  map_height: 30.0
  patrol_points:
    - [10.0, 10.0]
    - [20.0, 10.0]
    - [20.0, 20.0]
    - [10.0, 20.0]
  event_generation_rate: 3.0
  max_episode_time: 300.0  # 5λ¶„
```

### ν‘μ¤€ ν•™μµ
```yaml
# configs/default.yaml (ν„μ¬ μ„¤μ •)
env:
  map_width: 50.0
  map_height: 50.0
  patrol_points: [4κ° μ •μ‚¬κ°ν•]
  event_generation_rate: 5.0
  max_episode_time: 600.0  # 10λ¶„
```

### κ³ κΈ‰ ν•™μµ / μ‹¤μ „
```yaml
# configs/realistic.yaml
env:
  map_width: 100.0
  map_height: 60.0
  patrol_points: [8-12κ°, μ‹¤μ  λ°°μΉ]
  event_generation_rate: 10.0
  max_episode_time: 1800.0  # 30λ¶„
```

---

## π€ μ‚¬μ© μμ‹

### κΈ°λ³Έ μ„¤μ •μΌλ΅ ν•™μµ
```bash
python scripts/train.py
```

### μ»¤μ¤ν…€ μ„¤μ •μΌλ΅ ν•™μµ
```bash
python scripts/train.py --config configs/building_302.yaml
```

### μ—¬λ¬ μ„¤μ • λΉ„κµ
```bash
# κ° μ„¤μ •μΌλ΅ ν•™μµ
python scripts/train.py --config configs/default.yaml --seed 42
python scripts/train.py --config configs/corridor.yaml --seed 42
python scripts/train.py --config configs/high_density.yaml --seed 42

# κ²°κ³Ό λΉ„κµ
python scripts/evaluate.py --model checkpoints/default/final.pth
python scripts/evaluate.py --model checkpoints/corridor/final.pth
python scripts/evaluate.py --model checkpoints/high_density/final.pth
```

---

## π“ λ§µ μ‹κ°ν™”

### μ½”λ“λ΅ λ§µ ν™•μΈ
```python
from rl_dispatch.core.config import EnvConfig
import matplotlib.pyplot as plt

# μ„¤μ • λ΅λ“
config = EnvConfig.load_yaml("configs/default.yaml")

# μ‹κ°ν™”
fig, ax = plt.subplots(figsize=(10, 10))

# λ§µ κ²½κ³„
ax.add_patch(plt.Rectangle(
    (0, 0), config.map_width, config.map_height,
    fill=False, edgecolor='black', linewidth=2
))

# μμ°° ν¬μΈνΈ
patrol_x = [pt[0] for pt in config.patrol_points]
patrol_y = [pt[1] for pt in config.patrol_points]
ax.scatter(patrol_x, patrol_y, s=300, c='blue', marker='o')

# μμ°° κ²½λ΅
route_x = patrol_x + [patrol_x[0]]
route_y = patrol_y + [patrol_y[0]]
ax.plot(route_x, route_y, 'b--', alpha=0.5)

ax.set_xlim(-5, config.map_width + 5)
ax.set_ylim(-5, config.map_height + 5)
ax.set_aspect('equal')
plt.title('Patrol Map Layout')
plt.show()
```

### μ¤ν¬λ¦½νΈλ΅ μ‹κ°ν™”
```bash
# λ§µ λ μ΄μ•„μ›ƒ ν™•μΈ
python scripts/visualize_map.py

# ν•™μµ κ²°κ³Ό κ²½λ΅ μ‹κ°ν™”
python scripts/evaluate.py --model checkpoints/final.pth --visualize
```

---

## β“ FAQ

### Q: λ§µ ν¬κΈ°λ¥Ό λ³€κ²½ν•λ©΄ ν•™μµμ„ λ‹¤μ‹ ν•΄μ•Ό ν•λ‚μ”?
**A**: λ„¤, λ§µ κµ¬μ„±μ΄ λ³€κ²½λλ©΄ κ΄€μΈ΅κ°’κ³Ό λ³΄μƒμ΄ λ‹¬λΌμ§€λ―€λ΅ μƒλ΅ ν•™μµν•΄μ•Ό ν•©λ‹λ‹¤.

### Q: μμ°° ν¬μΈνΈλ” λ‡ κ°κΉμ§€ κ°€λ¥ν•κ°€μ”?
**A**: μµμ† 2κ° μ΄μƒμ΄λ©΄ μ ν• μ—†μµλ‹λ‹¤. λ‹¤λ§ λ„λ¬΄ λ§μΌλ©΄ (>15κ°) ν•™μµμ΄ λλ ¤μ§ μ μμµλ‹λ‹¤.

### Q: μ‹¤μ  κ±΄λ¬Όμ— μ μ©ν•λ ¤λ©΄?
**A**:
1. κ±΄λ¬Ό ν‰λ©΄λ„μ—μ„ μ£Όμ” μμ°° μ§€μ  μ„ μ •
2. μ‹¤μ  κ±°λ¦¬ μΈ΅μ •ν•μ—¬ μΆν‘ λ³€ν™
3. configs/my_building.yaml μƒμ„±
4. μ‹λ®¬λ μ΄μ…μΌλ΅ λ¨Όμ € ν…μ¤νΈ
5. Gazeboλ΅ κ²€μ¦ ν›„ μ‹¤μ  λ΅λ΄‡ λ°°ν¬

### Q: μ°μ„ μμ„(priority)λ” μ–΄λ–»κ² μ„¤μ •ν•λ‚μ”?
**A**:
- 1.0: λ³΄ν†µ μ¤‘μ”λ„ (κΈ°λ³Έκ°’)
- 1.5-2.0: λ†’μ€ μ¤‘μ”λ„ (ν„κ΄€, λ΅λΉ„ λ“±)
- 0.5-0.8: λ‚®μ€ μ¤‘μ”λ„ (μ°½κ³ , λΉ„μƒκµ¬ λ“±)

---

## π“ μ°Έκ³  μλ£

- **μ„¤μ • νμΌ λ¬Έλ²•**: `configs/README.md`
- **ν™κ²½ κµ¬μ„±**: `src/rl_dispatch/core/config.py`
- **μ‹κ°ν™” μμ‹**: `src/rl_dispatch/utils/visualization.py`
- **μ „μ²΄ λ¬Έμ„**: `README.md`, `QUICK_START.md`

---

**λ§μ§€λ§‰ μ—…λ°μ΄νΈ**: 2025-12-29
**μ‘μ„±μ**: λ°•μ©μ¤€ (YJP)
